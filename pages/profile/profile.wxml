<!--pages/profile/profile.wxml-->
<view class="page-container">

  <!-- é¡¶éƒ¨æ¨ªå¹…å›¾ -->
  <view class="hero-banner">
    <image class="hero-img" src="/images/banner-samo.png" mode="aspectFill" />
    <view class="hero-overlay"></view>
  </view>

  <scroll-view scroll-y="true" class="scroll-area" refresher-enabled="{{true}}" bindrefresherrefresh="onPullDownRefresh" refresher-triggered="{{refreshing}}">
    <view class="content" style="padding-top: {{contentPaddingTop}}px;">

      <!-- ç”¨æˆ·å¡ç‰‡ -->
      <view class="card user-card">
        <view class="user-info-row">
          <view class="avatar-wrap">
            <text class="avatar-emoji">ğŸ¶</text>
          </view>
          <view class="user-text">
            <text class="user-nickname">{{userInfo.nickName || 'ç‹—ç‹—ç”¨æˆ·'}}</text>
            <text class="user-id">ID: {{userId}}</text>
          </view>
        </view>
      </view>

      <!-- æ¯æ—¥è¿åŠ¿ -->
      <view class="fortune-card">
        <image class="fortune-dog-deco" src="/images/fortune-deco.jpg" mode="aspectFill" />
        <view class="fortune-content">
          <text class="fortune-text">{{fortune}}</text>
          <text class="fortune-advice">{{advice}}</text>
        </view>
      </view>

      <!-- ä»Šæ—¥æé—® -->
      <view class="card today-card">
        <view class="today-left">
          <text class="today-icon">ğŸ”¥</text>
          <text class="today-label">ä»Šæ—¥æé—®</text>
        </view>
        <text class="today-count">{{todayCount}}</text>
      </view>

      <!-- ç»Ÿè®¡ç½‘æ ¼ -->
      <view class="stats-grid">
        <view class="stats-grid-item">
          <text class="stats-icon stats-icon-orange">ğŸ“ˆ</text>
          <text class="stats-num stats-num-orange">{{stats.totalQuestions}}</text>
          <text class="stats-label">æ€»æé—®</text>
        </view>
        <view class="stats-grid-item">
          <text class="stats-icon stats-icon-red">â¤ï¸</text>
          <text class="stats-num stats-num-red">{{stats.totalLikes}}</text>
          <text class="stats-label">è·èµæ•°</text>
        </view>
        <view class="stats-grid-item">
          <text class="stats-icon stats-icon-blue">ğŸ‘ï¸</text>
          <text class="stats-num stats-num-blue">{{stats.totalViews}}</text>
          <text class="stats-label">æ€»æµè§ˆ</text>
        </view>
        <view class="stats-grid-item">
          <text class="stats-icon stats-icon-orange">ğŸ”¥</text>
          <text class="stats-num stats-num-orange">{{stats.daysActive}}</text>
          <text class="stats-label">æ´»è·ƒå¤©æ•°</text>
        </view>
      </view>

      <!-- æœ€è¿‘æé—® -->
      <view class="card recent-section">
        <view class="recent-header">
          <view class="recent-header-left">
            <text class="recent-icon">ğŸ’¬</text>
            <text class="recent-title">æœ€è¿‘æé—®</text>
          </view>
          <text class="recent-viewall" bindtap="navigateToHistory">æŸ¥çœ‹å…¨éƒ¨</text>
        </view>

        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{myQuestions.length === 0}}">
          <text class="empty-emoji">ğŸ¤”</text>
          <text class="empty-text">è¿˜æ²¡æœ‰æé—®è®°å½•</text>
          <button class="btn-primary go-ask-btn" bindtap="navigateToHome">å»æé—®</button>
        </view>

        <!-- æé—®åˆ—è¡¨ -->
        <view wx:else>
          <view class="question-item" wx:for="{{myQuestions}}" wx:key="_id" bindtap="onQuestionTap" data-id="{{item._id}}">
            <text class="question-text">{{item.question}}</text>
            <text class="question-date">{{item.dateStr}}</text>
          </view>
        </view>
      </view>

      <!-- æ·±è‰²æ¨¡å¼ -->
      <view class="card theme-card">
        <view class="theme-left">
          <text class="theme-icon">{{darkMode ? 'â˜€ï¸' : 'ğŸŒ™'}}</text>
          <text class="theme-label">æ·±è‰²æ¨¡å¼</text>
        </view>
        <switch checked="{{darkMode}}" bindchange="toggleTheme" color="#F97316" />
      </view>

      <!-- è®¾ç½® -->
      <view class="card settings-card">
        <view class="settings-item" bindtap="handleSettings">
          <text class="settings-icon">âš™ï¸</text>
          <text class="settings-text">è®¾ç½®</text>
        </view>
        <view class="settings-item" bindtap="handleFeedback">
          <text class="settings-icon">â“</text>
          <text class="settings-text">æ„è§åé¦ˆ</text>
        </view>
        <view class="settings-item" bindtap="handleAgreement">
          <text class="settings-icon">ğŸ“„</text>
          <text class="settings-text">ç”¨æˆ·åè®®</text>
        </view>
        <view class="settings-item" bindtap="handlePrivacy">
          <text class="settings-icon">ğŸ›¡ï¸</text>
          <text class="settings-text">éšç§æ”¿ç­–</text>
        </view>
        <view class="settings-item" bindtap="handleAbout">
          <text class="settings-icon">â„¹ï¸</text>
          <text class="settings-text">å…³äºæˆ‘ä»¬</text>
        </view>
        <view class="settings-item" bindtap="handleClearCache">
          <text class="settings-icon">ğŸ—‘ï¸</text>
          <text class="settings-text">æ¸…é™¤ç¼“å­˜</text>
        </view>
        <view class="settings-item settings-item-danger" bindtap="handleLogout">
          <text class="settings-icon">ğŸšª</text>
          <text class="settings-text-danger">é€€å‡ºç™»å½•</text>
        </view>
      </view>

      <!-- Footer -->
      <view class="footer">
        <text class="footer-version">ç‹—ç‹—å†›å¸ˆ v2.0</text>
        <text class="footer-slogan">äººç”Ÿè¿·èŒ«ï¼Ÿç‹—å¤´æ¥å¸®ï¼</text>
      </view>

    </view>
  </scroll-view>
</view>
